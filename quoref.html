<!doctype html>
<html lang="en">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
        <title>Smart Question Answering</title>
        <link href="main.css" rel="stylesheet" />
        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
        <script src="main.js"></script>
        <script src="sample-span-highlight.js"></script>
    </head>
    <body>
        <form name='mturk_form' method='post' id='mturk_form' action='https://www.mturk.com/mturk/externalSubmit'>
            <input type='hidden' value='' name='assignmentId' id='assignmentId' />
            <div id="root" class="container">
                <div class="row mb-4">
                    <div class="col">
                        <h1 class="text-center">Questions that require tracking entity references</h1>
                        <div class="card">
                            <a class="card-header" data-toggle="collapse" href="#collapseInstructions" aria-expanded="true" aria-controls="collapseInstructions">
                                <h3> Instructions (click to collapse) </h3>
                            </a>
                            <div id="collapseInstructions" class="collapse show">
                                <div class="card-body">
                                    <p class="card-text">
                                        <b>This is a pilot annotation task. We are still trying to assess its feasibility. Once we get an understanding of how difficult this task is, we will update the pay rate accordingly.
					    Your feedback will greatly help us in this process. So please remember to use the feedback box at the bottom of this page to let us know what you think!
					    We will also make note of workers who make good submissions now, and add many more HITs with a generous pay rate for them later.
					</b>
                                    </p>
                                    <p class="card-text">
                                        In this task, you will look at paragraphs that contain several phrases that are references to names of
                                        people, places, or things. For example, in the first sentence from sample paragraph below,
					the names <i>Jack Dawkins</i> and <i>the Artful Dodger</i> refer to the same person, and <i>old gentleman's residence</i>
					and <i>their lair</i> refer to the same place. You will notice that multiple phrases often refer to the same person, place, or thing.
                                        Your job is to write questions that you would ask a person to see if they understood that the
					phrases refer to the same entity. To help you write such questions, we provided some examples of good questions
					you can ask about such phrases, and bad questions you should avoid. We also want you to avoid questions that can be answered
					correctly by someone without actually understanding the paragraph. To help you do so, we provided an AI system running in the background
					that will try to answer the questions you write. You can consider any question it can answer to be too easy. <b>However, please note that
					the AI system incorrectly answering a question does not necessarily mean that it is good. Please read the examples below carefully to
					understand what kinds of questions we are interested in.</b>
					
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mb-4">
                    <div class="col">
                        <div class="card">
                            <a class="card-header" data-toggle="collapse" href="#collapseExamples" aria-expanded="true" aria-controls="collapseExamples">
                                <h3>Examples of good questions and answers (click to collapse) </h3>
                            </a>
                            <div id="collapseExamples" class="collapse show">
                                <div class="card-body">
                                    <h5 class="card-text text-center">
                                        Move your mouse over a question to
                                        highlight the parts of the passage that
                                        are relevant to the question.
                                    </h5>
                                    <div class="container">
                                        <div class="row">
                                            <div class="col">
                                                <div class="card sticky-top">
                                                    <div class="card-header">
                                                        <h2>Passage</h2>
                                                    </div>
                                                    <div class="card-body">
                                                        <div id="passage-sample" class="card-text">
                                                            Nearing London, <span class="sample-span span1b">Oliver</span> encounters <span class="sample-span span34b">Jack
                                                            Dawkins</span>, a pickpocket
                                                            more commonly known by the nickname
                                                            <span class="sample-span span2b">the "Artful Dodger"</span>, and <span class="sample-span span2a">his</span>
                                                                sidekick, a boy of a humorous nature named
                                                            <span class="sample-span span3c">Charley Bates</span>, but Oliver's innocent and trusting nature fails to see
                                                            any dishonesty in <span class="sample-span span3a">their</span> actions.
                                                            <span class="sample-span span4a">The Dodger</span> provides Oliver
                                                            with a free meal and tells him of a gentleman in London who will "give him lodgings for
                                                            nothing, and never ask for change". Grateful for the unexpected assistance, Oliver follows
                                                            the Dodger to <span class="sample-span span7a"><span class="sample-span span6b">the "old gentleman's" residence</span></span>. In this way
                                                            Oliver unwittingly falls in with an infamous Jewish criminal known as Fagin, the gentleman
                                                            of whom the Artful Dodger spoke. Ensnared, Oliver lives with Fagin and his gang of juvenile
                                                            pickpockets in <span class="sample-span span7b"><span class="sample-span span6a">their lair</span></span> at Saffron Hill for some time, unaware
                                                            of their criminal occupations. <span class="sample-span span1a">He</span> believes they make wallets and handkerchiefs.
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col" id="exampleQuestions">
                                                <h5>
                                                    Questions that link pronouns (she, her, him, his, their etc.) to people, places, or things to which they refer
                                                </h5>
                                                <div class="card mb-2" onmouseover="highlight_q1();" onmouseout="reset_higlight();">
                                                    <div class="card-body">
                                                        <p class="card-text">
                                                            Question: Who believes Fagin's gang make wallets and handkerchiefs? <br/>
                                                            Answer: <b>Oliver</b><br/>
                                                            Notes: Question evaluates the understanding that the pronoun highlighted in blue refers to name highlighted in green. You can ask questions
                                                            like this one about most pronouns in a paragraph.
                                                        </p>
                                                    </div>
                                                </div>
                                                <div class="card mb-2" onmouseover="highlight_q2();" onmouseout="reset_higlight();">
                                                    <div class="card-body">
                                                        <p class="card-text">
                                                            Question: What is the alias of the person whose sidekick had a humorous nature? <br/>
                                                            Answer: <b>the "Artful Dodger"</b><br/>
                                                            Notes: The pronoun highlighted in blue refers to a person with multiple names. But since the question explicitly asks
                                                            for the alias, the answer is unambiguous.
                                                        </p>
                                                    </div>
                                                </div>
                                                <div class="card mb-2" onmouseover="highlight_q3();" onmouseout="reset_higlight();">
                                                    <div class="card-body">
                                                        <p class="card-text">
                                                            Question: What are the names of the people whose dishonesty Oliver failed to see? <br/>
                                                            Answer: <b>Jack Dawkins</b>; <b>Charley Bates</b><br/>
                                                            Notes: Pronoun (in blue) refers to two different people (in green).
                                                        </p>
                                                    </div>
                                                </div>
                                                <hr>
                                                <h5>
                                                    Questions that link other references to people, places, or things
                                                </h5>
                                                <div class="card mb-2" onmouseover="highlight_q4();" onmouseout="reset_higlight();">
                                                    <div class="card-body">
                                                        <p class="card-text">
                                                            Question: What is the Dodger's real name? <br/>
                                                            Answer: <b>Jack Dawkins</b> <br/>
                                                            Notes: Question evaluates the understanding that "The Dodger" and "Jack Dawkins" are the same person.
                                                        </p>
                                                    </div>
                                                </div>
                                                <div class="card mb-2" onmouseover="highlight_q5();" onmouseout="reset_higlight();">
                                                    <div class="card-body">
                                                        <p class="card-text">
                                                            Question: What is the real name of the person who provided Oliver with a free meal? <br/>
                                                            Answer: <b>Jack Dawkins</b><br/>
                                                            Notes: This question is about the same connection as the last one, but this one uses information surrounding the alias instead of the alias itself.
                                                        </p>
                                                    </div>
                                                </div>
                                                <div class="card mb-2" onmouseover="highlight_q6();" onmouseout="reset_higlight();">
                                                    <div class="card-body">
                                                        <p class="card-text">
                                                            Question: Which place served as Fagin and his gang's lair? <br/>
                                                            Answer: <b>the "old gentleman's" residence</b><br/>
                                                            Notes: Question evaluates the understanding that the highlighted phrases are references to the same place. The answer is the phrase in green.
                                                        </p>
                                                    </div>
                                                </div>
                                                <div class="card mb-2" onmouseover="highlight_q7();" onmouseout="reset_higlight();">
                                                    <div class="card-body">
                                                        <p class="card-text">
                                                            Question: Where is the old gentleman's residence? <br />
                                                            Answer: <b>Saffron Hill</b> <br />
                                                            Notes: This is also about the connection between the same two phrases as the last one, but mentions the previous answer and asks for information near the phrase in green,
                                                            and thus the answer here is different.<br />
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="card">
                            <a class="card-header" data-toggle="collapse" href="#collapseBadExamples" aria-expanded="true" aria-controls="collapseBadExamples">
                                <h3>Examples of bad questions and answers (click to collapse) </h3>
                            </a>
                            <div id="collapseBadExamples" class="collapse show">
                                <div class="card-body">
                                    <h5 class="card-text text-center">
                                        Move your mouse over a question to
                                        highlight the parts of the passage that
                                        are relevant to the question.
                                    </h5>
                                    <div class="container">
                                        <div class="row">
                                            <div class="col">
                                                <div class="card sticky-top">
                                                    <div class="card-header">
                                                        <h2>Passage</h2>
                                                    </div>
                                                    <div class="card-body">
                                                        <div id="passage-sample" class="card-text">
								In The Tangled Skein, Queen Mary is characterized as a loving woman with a strong sense of justice. The tangled skein arises from Mary's
								love for the fictional character <span class="sample-span span11b">Robert d'Esclade</span>, <span class="sample-span span11b">fifth Duke of Wessex</span>, said
								in this book to be the people's choice as King Consort.
								<span class="sample-span span11b">Wessex</span> is chivalrous and charming, but semi-betrothed to Lady Ursula Glynde, whom <span class="sample-span span11a">he</span> has not seen since her infancy.
								<span class="sample-span span11b">Wessex</span> is repelled
								by the idea of having his wife thrust upon him and purposely avoids Lady Ursula. Unknown to <span class="sample-span span11b">Wessex</span>, the
								Queen jealously guards him
								against Ursula, who is extremely beautiful. As soon as she realizes the Queen is keeping her away from <span
									class="sample-span span11b">Wessex</span>, Ursula is angered. She
								believes she loves <span class="sample-span span11b">Wessex</span>, for his nobility and goodness, and she is invested heavily in the betrothal. <span class="sample-span span10">On her father's deathbed, Ursula
									promised to go into a convent if she did not marry <span class="sample-span span11b">Wessex</span></span>. Although Ursula does not want to lose her independence by marrying, she seeks
								to frustrate the Queen's plans and make <span class="sample-span span11b">Wessex</span> notice her; however, the arrival of Cardinal de Moreno, and
								<span class="sample-span span12a">his henchman</span> <span class="sample-span span12b">Don Mignel</span>,
								<span class="sample-span span12b">Marquis de Saurez</span>, shifts the scene.
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col" id="exampleQuestions">
                                                <h5>
                                                    Avoid questions that do not link phrases referring to the same entity
                                                </h5>
                                                <div class="card mb-2" onmouseover="highlight_q10();" onmouseout="reset_higlight();">
                                                    <div class="card-body">
                                                        <p class="card-text">
                                                            Bad Question: Who does Ursula promise to? <br/>
                                                            Answer: <b>her father</b><br/>
							    Why it is bad: There is only one mention of Ursula's her father in the sentence highlighted. Hence, this question does not require
							    linking two different phrases that refer to the same entity.<br />
                                                            Notes: When you write questions, it will be helpful to think about the phrases referring to entities that they link. If you cannot think of
							    more than one such phrase, it is likely a bad question.
                                                        </p>
                                                    </div>
                                                </div>
						<hr>
                                                <h5>
                                                    Avoid questions that have multiple answers
                                                </h5>
                                                <div class="card mb-2" onmouseover="highlight_q11();" onmouseout="reset_higlight();">
                                                    <div class="card-body">
                                                        <p class="card-text">
                                                            Bad Question: Who has not seen Ursula since her infancy? <br/>
							    Answers: <b>Wessex</b>, <b>Robert d'Esclade</b>, <b>Robert d'Esclade, fifth Duke of Wessex</b><br/>
							    Why it is bad: The question links "he" (in blue) to the name of that person, but the person is referred to by multiple names (in green), which are all correct answers.<br/>
                                                            Notes: You can instead ask <i>What is the full name of the person who has not seen Ursula since here infancy?</i>, and the answer would be
							    <b>Robert d'Esclade</b>.
                                                        </p>
                                                    </div>
                                                </div>
						<hr>
                                                <h5>
                                                    Submit answers with multiple entities as separate spans
                                                </h5>
                                                <div class="card mb-2" onmouseover="highlight_q12();" onmouseout="reset_higlight();">
                                                    <div class="card-body">
                                                        <p class="card-text">
                                                            Question: Who are the cardinal's henchmen? <br/>
							    Bad Answer: <b>Don Mignel, Marquis de Saurez</b> (single selection)<br/>
							    Good answer: <b>Don Mignel</b>;  <b>Marquis de Saurez</b> (separate selections)<br/>
                                                            Notes: This question asks for the names of multiple people. Note that this is different from asking for a single person with multiple names
							    like the previous question. When the answer is names of multiple people, submit them as multiple spans by highlighting each name separately,
							    and using the "Add Another Span" button to add spans.
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <h2>Let's start writing some questions now!</h2>
                        <h4>Please keep in mind the following:</h4>
                        <ol>
                            <li> For each of your questions the answer should be one or more phrases in the paragraph. 
                            </li>
                            <li> The answer for each question should be unambiguous. Please avoid questions that can have more than one answers.
                            </li>
                            <li> There is an AI system running in the background that will try to answer your question as
                                soon as you are done typing. If the system's answer is correct, please change your question, as it may be too easy. After you
                                find a good question, please also select the correct answer from the paragraph by highlighting the relevant spans with your mouse.
                            </li>
                            <li>
                                If your answer has multiple spans, you can submit them by clicking on the "Add Another Span" button under the last answer box, and selecting additional spans as
				appropriate. To remove previously added spans, you can click on the "Delete Span" buttons next to the answer boxes.
                            </li>
                            <li> Once you add a question, it appears below the answer area. If you are unhappy with a question you added, you can edit it or delete it. </li>
                            <li> You have <b>3 passages</b> to pick from, and over these three passages, you must write <b>at least 10 questions</b> to submit the HIT.
                                You will see a counter that shows the total number of questions submitted so far. </li>
                            <li> You can go back and forth between the passages. Some passages are easier to generate questions from than
                                others, so if you have a hard time, move to a different passage.
                            </li>
                        </ol>
                    </div>
                </div>
                <div class="card mb-4">
                    <div class="card-header">
                        <h3>
			    Total Questions Written in HIT: <span id="numQuestionsWritten"></span><br />
                            Counting Questions Written in HIT: <span id="countQuestionsWritten"></span>
                        </h3>
                    </div>
                    <div class="card-body">
                        <div class="container">
                            <div class="row">
                                <div class="col">
                                    <div class="card">
                                        <div class="card-header">
                                            <h2>
                                                Passage <span id="passageNum"></span>
                                            </h2>
                                        </div>
                                        <div class="card-body">
                                            <div class="card-text">
                                                <div id="passage" onmouseup="getPassageSelectionIndices(); return false;">
                                                    <strong>Loading passages...</strong>
                                                    <div class="spinner-border" role="status">
                                                        <span class="sr-only"></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="card sticky-top">
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col">
                                                    <h2>Write a question about the passage</h2>
                                                    <input type="text" class="form-control" id="input-question" name="input-question" placeholder="Write a question here!" onkeyup="getAIAnswer();">
                                                </div>
                                            </div>
                                            <div class="row mt-4">
                                                <div class="col">
                                                    <h4>Your Answer</h4>
                                                    <div class="radio">
                                                        <label><input type="radio" name="answer" id="span_answer" name="span_answer" value='span' onchange="return initializeSpanAnswer();"> Start highlighting the answer</label>
                                                    </div>
                                                    <div id="answersWritten">
                                                    </div>
                                                    <button type="button" id="add_span" class="btn btn-primary mt-2" onclick="return addSpan();" disabled style="display:none">
                                                        Add Another Span
                                                    </button>
                                                    <div id="error_panel">
                                                    </div>
                                                    <button type="button" id="next_question" class="btn btn-primary mt-4" disabled onclick="create_question();">
                                                        Add Question
                                                    </button>
                                                </div>
                                                <div class="col">
                                                    <h4>AI predicted:<br />(wait for answer to appear below)</h4>
                                                    <div class="card bg-light">
                                                        <div class="card-body">
                                                            <samp id="ai-answer"></samp>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col" id="questionsWritten">
                                                    <h3>Questions written for this passage:</h3>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mb-4">
                    <div class="col text-center">
                        <button id="prev_passage" type="button" class="btn btn-primary" onclick="previousPassage();">
                            Previous Passage
                        </button>
                        <button id="next_passage" type="button" class="btn btn-primary" onclick="nextPassage();">
                            Next Passage
                        </button>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="card mb-4">
                            <div class="card-header">
                                <h3>
                                    Please leave your feedback here
                                </h3>
                            </div>
                            <div class="card-body">
                                <div id="comment">
                                    <textarea class="form-control" rows="3" type="text" id="feedback" placeholder="Please leave your feedback here."></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mb-4">
                    <div class="col text-center">
                        <button id="ready_submit" type="button" class="btn btn-secondary" onclick="final_submit();" disabled>
                            Ready to Submit HIT
                        </button>
                    </div>
                </div>
                <div class="row mb-4 text-center" id="submission_container" style="display:none">
                    <div class="col">
                        <h2>Thank you for helping with our research!</h2>
                        <input type='submit' class="btn btn-success" id='submitButton' name="submitButton" disabled value='Submit HIT'>
                    </div>
                </div>
                <input id="generated_answers" name="generated_answers" type="hidden">
            </div>
        </form>
        <script language='Javascript'>
         turkSetAssignmentID();
        </script>
    </body>
</html>
